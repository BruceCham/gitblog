---
layout: default
title: 为爱升温
---
<link href="/gitblog/css/h5_love/main.css" rel="stylesheet" type="text/css" />
<div class="infoSec" style="background:url(/gitblog/images/h5_love/bg5.jpg) no-repeat;background-size:100% 100%">
	<!--爱情温度区-->
	<div class="lovesoeal"></div>
	<div class="lovekedu"></div>
	<div class="lovewendu"></div>
	<div class="lovewendu2"></div>
	<div class="lovewendu3">
		<div class="lovenum">
			<div class="wnum">5<span>20</span>°C</div>
			<div class="lines">爱升温<span>20</span>°C</div>
		</div>
		<div class="lovezan"></div>
	</div>
	<!--个人信息区-->
	<div class="wxinfo">
		<div class="wxname">至尊宝</div>
		<div class="wxphoto"><b><img src/></b></div>
		<div class="wxaudio audioN"></div>
		<div class="wxmusic btnPause"></div>
	</div>
</div>
<audio src="/gitblog/audio/heart.mp3" preload="preload" loop="" style="display:none;" id="loveheart"></audio>
<audio src="/gitblog/audio/hearts.mp3" preload="preload" style="display:none;" id="mylovewords"></audio>
<!-- <script src="/gitblog/lib/jquery-2.0.3.min.js"></script> -->
<!-- <script src="/gitblog/js/h5_love/global.js"></script> -->
<!-- <script src="/gitblog/js/h5_love/main.js"></script> -->
<script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript">
//内容模型
var shareData = {
    imgUrl:"http://www.itsabutterfly.com/activity/valentine/img/share.jpg",
    imgWidth:"600",
    imgHeight:"600",
    link:window.location.href,
    desc:"",
    title:"我大声说出爱的就是你，我们的爱"
};
function $cookie(name, value, options) {
		if (typeof value != 'undefined') {
			options = options || {};
			if (value === null) {
				value = '';
				options.expires = -1
			}
			var expires = '';
			if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
				var date;
				if (typeof options.expires == 'number') {
					date = new Date();
					date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000))
				} else {
					date = options.expires
				}
				expires = '; expires=' + date.toUTCString()
			}
			var path = options.path ? '; path=' + options.path : '';
			var domain = options.domain ? '; domain=' + options.domain : '';
			var secure = options.secure ? '; secure' : '';
			document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('')
		} else {
			var cookieValue = null;
			if (document.cookie && document.cookie != '') {
				var cookies = document.cookie.split(';');
				for (var i = 0; i < cookies.length; i++) {
					var cookie = jQuery.trim(cookies[i]);
					if (cookie.substring(0, name.length + 1) == (name + '=')) {
						cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
						break
					}
				}
			}
			return cookieValue
		}
}
// 分享
function shareFriend() {
    WeixinJSBridge.invoke('sendAppMessage', {
        "img_url":shareData.imgUrl,
        "img_width":shareData.imgWidth,
        "img_height":shareData.imgHeight,
        "link":shareData.link,
        "desc":shareData.desc,
        "title":shareData.title
    }, function (res) {
        _report('send_msg', res.err_msg);
    })
}
function shareTimeline() {
    WeixinJSBridge.invoke('shareTimeline', {
        "img_url":shareData.imgUrl,
        "img_width":shareData.imgWidth,
        "img_height":shareData.imgHeight,
        "link":shareData.link,
        "desc":shareData.desc,
        "title":shareData.title
    }, function (res) {
        _report('timeline', res.err_msg);
    });
}
function shareWeibo() {
    WeixinJSBridge.invoke('shareWeibo', {
        "content":shareData.title,
        "url":shareData.link
    }, function (res) {
        _report('weibo', res.err_msg);
    });
}
// 当微信内置浏览器完成内部初始化后会触发WeixinJSBridgeReady事件。
try {
    document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
        WeixinJSBridge.on('menu:share:appmessage', function (argv) {
            shareFriend();
        });
        WeixinJSBridge.on('menu:share:timeline', function (argv) {
            shareTimeline();
        });
        WeixinJSBridge.on('menu:share:weibo', function (argv) {
            shareWeibo();
        });
        WeixinJSBridge.call('hideToolbar');
    }, false);
} catch (err) {

}
</script>
<script type="text/javascript">
function audioFn(srcs){
	var _audioWords = document.getElementById("mylovewords");
	var _audioHeart = document.getElementById("loveheart");
	_audioWords.addEventListener("play", function () {
        console.log("playing....");
		_audioHeart.pause();
    });
    _audioWords.addEventListener("pause", function () {
        console.log("pause....");
		setTimeout(function(){
			$('.wxaudio').removeClass("audioN").addClass("audioY");
		},501);
		if(!$(".wxmusic").hasClass("btnPause")){
			_audioHeart.play();
		}
    });
	_audioHeart.addEventListener("pause", function () {
        console.log("pause....");
		if(!$(".wxmusic").hasClass("btnPause")){
			_audioHeart.play();
		}
    });
    _audioWords.addEventListener("end", function () {
        console.log("end....");
		setTimeout(function(){
			$('.wxaudio').removeClass("audioN").addClass("audioY");
		},501);
		if(!$(".wxmusic").hasClass("btnPause")){
			_audioHeart.play();
		}
    });
}
function ValentineAni(){
	console.log("ValentineAni");
	if(loveScene.animateTag){
		var op = '<div class="myballC ballAnimate1"><img src="/gitblog/images/h5_love/club1.png"/></div><div class="myballC ballAnimate2"><img src="/gitblog/images/h5_love/club2.png"/></div><div class="myballC ballAnimate3"><img src="/gitblog/images/h5_love/club3.png"/></div><div class="myballC ballAnimate4"><img src="/gitblog/images/h5_love/club4.png"/></div><div class="myballC ballAnimate5"><img src="/gitblog/images/h5_love/club5.png"/></div><div class="myballC ballAnimate6"><img src="/gitblog/images/h5_love/club6.png"/></div><div class="myballC ballAnimate7"><img src="/gitblog/images/h5_love/club7.png"/></div>';
		$("body").append(op);
		loveScene.animateTag = !loveScene.animateTag;
		var myinterval = setInterval(function(){
			if(loveInfoFn.loveKeepTime++ > 20){
				clearInterval(myinterval);
				loveInfoFn.loveKeepTime = 0;
				loveScene.animateTag = !loveScene.animateTag;
				return false;
			}
			var op = '';
			for(var i=1;i<8;i++){
				var ant = parseInt(Math.random()*7+1);
				op = '<div class="myballC ballAnimate'+ant+'"><img src="/gitblog/images/h5_love/club'+ant+'.png"/></div>';
			}
			$("body").append(op);
			var arrs = $(".myballC");
			if(arrs && arrs.length > 1){
				for(var i=0;i<arrs.length;i++){
					$(arrs[i]).css("opacity")=="0"?$(arrs[i]).remove():"";
				}
			}
		},200);
		myinterval;
	}
}
var loveInfoFn = {
	loveNum : 0,
	loveKeepTime: 0,
	loveZan: 0,
	loveClick:0,
	loveId:0
}
var loveScene = {
	animateTag: true,
	init: function(){
			document.getElementById("loveheart").play();
			$(".wxname").html("BruceCham");
			$("#pcount").html(20);
			audioFn();
			var arrs = ["","2014，我会送你一次最浪漫的夕阳晚餐！","嫁给我吧！","让我带你去只有我们的爱情岛！","要月亮，不会给你星星！","让我给你一个家！"];
			
			var myhead = new Image;
			myhead.src = '/gitblog/images/h5_love/wxImg0.jpg';
			myhead.onload = function(){
				$(".wxphoto img").attr("src",myhead.src);
				setTimeout(function(){
					$(".wxaudio").removeClass("audioN").addClass("audioY");
					$(".wxmusic").removeClass("btnPause").addClass("btnPlay");
				},501);
			}					
			loveInfoFn.loveNum = 20;
			setTimeout(function(){
				$(".lovewendu3 .lovenum span").html(loveInfoFn.loveNum);
				$(".lovewendu3").css("bottom",loveInfoFn.loveNum<93?loveInfoFn.loveNum+"%":"92%");
				$(".lovewendu2").css("height",loveInfoFn.loveNum+"%");
				setTimeout(function(){
					$(".lovesoeal").css("height","110px");
				},1501);
				setTimeout(function(){ValentineAni();},2000);
			},2000);
	},
	events: function(){
		$(".lovewendu3").click(function(e){
			loveInfoFn.loveZan = parseInt(loveInfoFn.loveZan)+1;
			var arrs = ["","2014，我会送你一次最浪漫的夕阳晚餐！","嫁给我吧！","让我带你去只有我们的爱情岛！","要月亮，不会给你星星！","让我给你一个家！"];
			var ant = parseInt(loveInfoFn.loveId);
			loveInfoFn.loveNum = parseInt(loveInfoFn.loveNum) + 1;
			$(".lovewendu3 .lovenum span").html(loveInfoFn.loveNum);
			$(".lovewendu3").css("bottom",loveInfoFn.loveNum<93?loveInfoFn.loveNum+"%":"92%");
			$(".lovewendu2").css("height",loveInfoFn.loveNum+"%");
			ValentineAni();
		});
		$(".wxmusic").click(function(e){
			var that = $(e.currentTarget);
			that.hasClass("btnPlay")?function(){
				that.removeClass("btnPlay").addClass("btnPause");
				$(".wxaudio").removeClass("audioN").addClass("audioY");
				$("#loveheart")[0].pause();
				$("#mylovewords")[0].pause();
			}():function(){
				that.removeClass("btnPause").addClass("btnPlay");
				$(".wxaudio").removeClass("audioN").addClass("audioY");
				$("#mylovewords")[0].pause();
				$("#loveheart")[0].play();
			}();
		});
		$(".wxaudio").click(function(e){
			var that = $(e.currentTarget);
			that.hasClass("audioN")?function(){
				that.removeClass("audioN").addClass("audioY");
				$("#mylovewords")[0].pause();
			}():function(){
				that.removeClass("audioY").addClass("audioN");
				$(".wxmusic").removeClass("btnPlay").addClass("btnPause");
				$("#loveheart")[0].pause();
				$("#mylovewords")[0].play();
				//loveAnimateFn(1);
			}();
		});
		$(document).on("click",".myballC",function(e){
			var T = $(e.currentTarget);
			loveInfoFn.loveClick++;
			console.log("it is clicked");
			$(".myfinger").html('<div class="fingerClick">+'+loveInfoFn.loveClick+'</div>');
		});
		$(document).on('contextmenu', function(){return false;});
	}
}
$(function(){
		_prarm = 18;
		try{
			_prarm = window.location.href.match(/\?id=.*/).toString().substring(4);
		}catch(e){
			_prarm = 18;
		}
		loveScene.init();
		loveScene.events();
});
</script>